a:233:{i:0;a:3:{i:0;s:14:"document_start";i:1;a:0:{}i:2;i:0;}i:1;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:19:"Our Lab Environment";i:1;i:2;i:2;i:1;}i:2;i:1;}i:2;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:2;}i:2;i:1;}i:3;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:1;}i:4;a:3:{i:0;s:12:"externallink";i:1;a:2:{i:0;s:41:"https://www.virtualbox.org/wiki/Downloads";i:1;s:17:"Virtualbox 5.0.14";}i:2;i:34;}i:5;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:220:" will be used for this lab environment. Ample host machine resources are recommended. On the higher end of real world ZFS use cases where storage pools are very large and deduplication is enabled, a storage host with 64 ";}i:2;i:97;}i:6;a:3:{i:0;s:7:"acronym";i:1;a:1:{i:0;s:2:"GB";}i:2;i:317;}i:7;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:61:" of RAM can be considered a resource-constrained environment.";}i:2;i:319;}i:8;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:380;}i:9;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:380;}i:10;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:385:"Our lab environment will not approach the use case described above. We would however like to create a simulacra of a nontrivially complex storage rack by populating the controller with many small virtual disks. This will allow us to take a deep dive into administering the storage system without the need for enormous computing resources; the guest VMs should only require between 2-4 ";}i:2;i:382;}i:11;a:3:{i:0;s:7:"acronym";i:1;a:1:{i:0;s:2:"GB";}i:2;i:767;}i:12;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:273:". Since our goal is to demonstrate storage, backup, and recovery systems, our host system should have sufficient resources to run several of these servers as well as their disaster recovery and failover components. The base VM's specific configurations can be found in the ";}i:2;i:769;}i:13;a:3:{i:0;s:12:"internallink";i:1;a:2:{i:0;s:39:"labenvironment#Virtualbox Configuration";i:1;s:24:"Virtualbox Configuration";}i:2;i:1042;}i:14;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:9:" section.";}i:2;i:1110;}i:15;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:1119;}i:16;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:1119;}i:17;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:460:"This lab will be based on CentOS 7 for its host systems. This choice was made due to its binary compatibility with Red Hat Enterprise Linux, a prolific commercial distribution used in many organizations. For those who are not familiar with CentOS or RHEL, there is a lot of good, detailed help out on the web about how to get by doing things in these distributions. The setup configuration used for the CentOS 7 servers in this environment can be found in the ";}i:2;i:1121;}i:18;a:3:{i:0;s:12:"internallink";i:1;a:2:{i:0;s:35:"labenvironment#CentOS Configuration";i:1;s:20:"CentOS Configuration";}i:2;i:1581;}i:19;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:9:" section.";}i:2;i:1641;}i:20;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:1650;}i:21;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:1650;}i:22;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:328:"At the time of writing, Debian is a popular choice for ZoL due to its conservative approach to updating packages. While ZoL is considered mature, it is a LKM highly dependent on many things in the kernel. Hasty kernel updates can break the module in unpredictable ways, so Debian's stable branch obviates this risk considerably.";}i:2;i:1652;}i:23;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:1980;}i:24;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:1980;}i:25;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:93:"Interestingly, it was recently announced that an upcoming LTS version of Ubuntu (16.04) will ";}i:2;i:1982;}i:26;a:3:{i:0;s:12:"externallink";i:1;a:2:{i:0;s:83:"http://blog.dustinkirkland.com/2016/02/zfs-is-fs-for-containers-in-ubuntu-1604.html";i:1;s:28:"ship with the kernel modules";}i:2;i:2075;}i:27;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:96:", requiring us to simply enable it to start using it. There is a bit to be made clear about the ";}i:2;i:2191;}i:28;a:3:{i:0;s:12:"externallink";i:1;a:2:{i:0;s:57:"https://sfconservancy.org/blog/2016/feb/25/zfs-and-linux/";i:1;s:22:"licensing implications";}i:2;i:2287;}i:29;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:223:", but the potential to mainstream ZFS is quite exciting for storage administrators in many organizations who are unable to move to a ZFS supported BSD or take on the challenge of adding ZoL to their existing infrastructure.";}i:2;i:2371;}i:30;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:2594;}i:31;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:2594;}i:32;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:227:"For the moment, we will be looking at getting these systems working in CentOS. Many of the details in using ZFS will not be materially different between Linux flavors for administrators, but installing ZoL will differ slightly.";}i:2;i:2596;}i:33;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:2823;}i:34;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:2825;}i:35;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:22:"Virtualbox Environment";i:1;i:3;i:2;i:2825;}i:2;i:2825;}i:36;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:3;}i:2;i:2825;}i:37;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:2825;}i:38;a:3:{i:0;s:6:"smiley";i:1;a:1:{i:0;s:5:"FIXME";}i:2;i:2859;}i:39;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:2864;}i:40;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:2864;}i:41;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:227:"Create a new VM with the latest CentOS 7 NetInstall ISO loaded in the optical disc drive. To install the base CentOS system unattended and deterministically, we will use a precongifured kickstart file (which can be reviewed in ";}i:2;i:2866;}i:42;a:3:{i:0;s:12:"externallink";i:1;a:2:{i:0;s:65:"https://gist.github.com/jcherven/13d5b725cd5163172a08e2ef86cdfafd";i:1;s:16:"this Github Gist";}i:2;i:3093;}i:43;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:62:"). Then we will use a post-installation script to install ZFS.";}i:2;i:3179;}i:44;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:3241;}i:45;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:3241;}i:46;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:231:"At the installation media's bootloader screen, press the tab key enter customized boot options. Clear everything after the initrd image and use the ks argument to specify the provided kickstart file. Your command should appear as: ";}i:2;i:3243;}i:47;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:3479;}i:48;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:83:" > vmlinuz initrd=initrd.img ks=https://projectdoc.jamescherven.com/zfsproject.cfg ";i:1;N;i:2;N;}i:2;i:3479;}i:49;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:3573;}i:50;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:24:"Virtualbox Configuration";i:1;i:3;i:2;i:3573;}i:2;i:3573;}i:51;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:3;}i:2;i:3573;}i:52;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:3573;}i:53;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:247:"This section will provide specific configuration information that will be used for the Virtualbox VM guests used in this document. Currently this document assumes running Virtualbox on a Windows host machine, but commands and scripts for Linux or ";}i:2;i:3609;}i:54;a:3:{i:0;s:7:"acronym";i:1;a:1:{i:0;s:2:"OS";}i:2;i:3856;}i:55;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:39:" X hosts may be included in the future.";}i:2;i:3858;}i:56;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:3897;}i:57;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:3897;}i:58;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:196:"Windows CMD commands will be provided so that the reader can easily follow and verify what is being described. Scripts will be provided separately for replicating the test environment on your own.";}i:2;i:3899;}i:59;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:4095;}i:60;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:4097;}i:61;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:16:"VM configuration";i:1;i:4;i:2;i:4097;}i:2;i:4097;}i:62;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:4;}i:2;i:4097;}i:63;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:4097;}i:64;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:239:"A CentOS 7 base VM will be created, from which clone VMs are spawned for use in the lab. This allows us to quickly create and destroy machines for testing and committing various configurations. The base VM can be created in the Virtualbox ";}i:2;i:4123;}i:65;a:3:{i:0;s:7:"acronym";i:1;a:1:{i:0;s:3:"GUI";}i:2;i:4362;}i:66;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:31:" with the following properties:";}i:2;i:4365;}i:67;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:4397;}i:68;a:3:{i:0;s:10:"listu_open";i:1;a:0:{}i:2;i:4397;}i:69;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:1;}i:2;i:4397;}i:70;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:4397;}i:71;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:19:" Name: CentOS7Box00";}i:2;i:4401;}i:72;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:4420;}i:73;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:4420;}i:74;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:1;}i:2;i:4420;}i:75;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:4420;}i:76;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:12:" Type: Linux";}i:2;i:4424;}i:77;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:4436;}i:78;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:4436;}i:79;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:1;}i:2;i:4436;}i:80;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:4436;}i:81;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:26:" Version: Red Hat (64-bit)";}i:2;i:4440;}i:82;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:4466;}i:83;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:4466;}i:84;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:1;}i:2;i:4466;}i:85;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:4466;}i:86;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:19:" Memory Size: 2048 ";}i:2;i:4470;}i:87;a:3:{i:0;s:7:"acronym";i:1;a:1:{i:0;s:2:"MB";}i:2;i:4489;}i:88;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:4491;}i:89;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:4491;}i:90;a:3:{i:0;s:13:"listitem_open";i:1;a:2:{i:0;i:1;i:1;i:1;}i:2;i:4491;}i:91;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:4491;}i:92;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:30:" Create new virtual hard disk:";}i:2;i:4495;}i:93;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:4525;}i:94;a:3:{i:0;s:10:"listu_open";i:1;a:0:{}i:2;i:4525;}i:95;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:2;}i:2;i:4525;}i:96;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:4525;}i:97;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:15:" <hostname>.vdi";}i:2;i:4531;}i:98;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:4546;}i:99;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:4546;}i:100;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:2;}i:2;i:4546;}i:101;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:4546;}i:102;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:10:" Size: 12 ";}i:2;i:4552;}i:103;a:3:{i:0;s:7:"acronym";i:1;a:1:{i:0;s:2:"GB";}i:2;i:4562;}i:104;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:4564;}i:105;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:4564;}i:106;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:2;}i:2;i:4564;}i:107;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:4564;}i:108;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:13:" Format: .vdi";}i:2;i:4570;}i:109;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:4583;}i:110;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:4583;}i:111;a:3:{i:0;s:13:"listitem_open";i:1;a:1:{i:0;i:2;}i:2;i:4583;}i:112;a:3:{i:0;s:16:"listcontent_open";i:1;a:0:{}i:2;i:4583;}i:113;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:67:" Variant: Standard (Dynamically allocated storage on physical disk)";}i:2;i:4589;}i:114;a:3:{i:0;s:17:"listcontent_close";i:1;a:0:{}i:2;i:4656;}i:115;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:4656;}i:116;a:3:{i:0;s:11:"listu_close";i:1;a:0:{}i:2;i:4656;}i:117;a:3:{i:0;s:14:"listitem_close";i:1;a:0:{}i:2;i:4656;}i:118;a:3:{i:0;s:11:"listu_close";i:1;a:0:{}i:2;i:4656;}i:119;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:4656;}i:120;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:124:"The Windows CMD shell commands, which you might find useful for replicating or scripting this configuration, are as follows.";}i:2;i:4658;}i:121;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:4782;}i:122;a:3:{i:0;s:2:"hr";i:1;a:0:{}i:2;i:4784;}i:123;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:4791;}i:124;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:4:"Note";i:1;i:5;i:2;i:4791;}i:2;i:4791;}i:125;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:5;}i:2;i:4791;}i:126;a:3:{i:0;s:10:"quote_open";i:1;a:0:{}i:2;i:4802;}i:127;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:129:" Use the vboxmanage command without being in the executable directory by adding the executable's directory to the PATH variable: ";}i:2;i:4804;}i:128;a:3:{i:0;s:9:"linebreak";i:1;a:0:{}i:2;i:4933;}i:129;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:4935;}i:130;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:50:" > PATH=%PATH%;C:\Program Files\Oracle\Virtualbox
";i:1;N;i:2;N;}i:2;i:4941;}i:131;a:3:{i:0;s:11:"quote_close";i:1;a:0:{}i:2;i:4999;}i:132;a:3:{i:0;s:2:"hr";i:1;a:0:{}i:2;i:5000;}i:133;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:149:"
> vboxmanage createvm --name "CentOS7Box00" --register
> vboxmanage createhd --filename "CentOS7Box00" --size 12000 --format vdi --variant standard
";i:1;N;i:2;N;}i:2;i:5012;}i:134;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:5012;}i:135;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:122:"This will create the VM XML definition file and register it in Virtualbox. The second command creates the root disk drive.";}i:2;i:5170;}i:136;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:5292;}i:137;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:207:"
> vboxmanage storagectl "CentOS7Box00" --name SATA --add sata --controller IntelAHCI
> vobxmanage storageattach "CentOS7Box00" --storagectl "SATA" --port 0 --device 0 --type hdd ^
--medium CentOS7Box00.vdi
";i:1;N;i:2;N;}i:2;i:5299;}i:138;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:5299;}i:139;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:185:"This creates a SATA controller on the VM, then attaches our root disk drive to it. The carat (^) at the end of line is the CMD shell's line continuation character. Omit where necessary.";}i:2;i:5515;}i:140;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:5700;}i:141;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:201:"
> vboxmanage storagectl "CentOS7Box00" --name "IDE" --add ide
> vboxmanage storageattach "CenOS7Box00" --storagectl "IDE" --port 0 --device 0 --type dvddrive ^
--medium "path/to/centOS 7 minimal.iso"
";i:1;N;i:2;N;}i:2;i:5707;}i:142;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:5707;}i:143;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:156:"This creates an IDE controller for our installation media. Point the second command at your downloaded ISO image of the CentOS 7 Minimal installation media.";}i:2;i:5918;}i:144;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:6074;}i:145;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:6076;}i:146;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:15:"Virtual Storage";i:1;i:4;i:2;i:6076;}i:2;i:6076;}i:147;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:4;}i:2;i:6076;}i:148;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:6076;}i:149;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:334:"In order to keep the test configurations simple, the virtual storage devices will be attached to the same SATA controller as the root media. In Virtualbox, there are some performance differences between SATA and SAS in certain situations, none of which are relevant to our environment. We will arbitrarily choose SATA for our devices.";}i:2;i:6100;}i:150;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:6434;}i:151;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:6434;}i:152;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:325:"The production storage VM will have nine drives in the storage array each at 200GB, an arbitrarily chosen size. This disk size can be adjusted depending on your own host machine's environment. The VM was created with the root device on the SATA controller's port 0, and we will populate the nine disks in the remaining ports.";}i:2;i:6436;}i:153;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:6761;}i:154;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:6761;}i:155;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:53:"The following CMD batch script describes the process.";}i:2;i:6763;}i:156;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:6822;}i:157;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:354:"
@echo off
setlocal enableDelayedExpansion
PATH=%PATH%;C:\Program Files\Oracle\Virtualbox

FOR /l %%I IN (1,1,9) DO (
    vboxmanage createhd --filename disk%%I --format vdi --size 20000 --variant standard
    vboxmanage storageattach DiskAttachTest --storagectl "SATA" --port %%I --device 0 --type hdd --medium "path\to\virtual\disks\disk%%I.vdi"
    )
";i:1;N;i:2;N;}i:2;i:6822;}i:158;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:6822;}i:159;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:98:"Starting this virtual machine should immediately boot from your CentOS Minimal installation media.";}i:2;i:7186;}i:160;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:7285;}i:161;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:7285;}i:162;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:20:"CentOS Configuration";i:1;i:3;i:2;i:7285;}i:2;i:7285;}i:163;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:3;}i:2;i:7285;}i:164;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:7285;}i:165;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:430:"CentOS should be either installed or configured from minimal installation with a static IP address and a hostname of your choosing. This will vary based on your individual test environment. For example, one might have the VM host running on an office network with the guest VMs configured for bridged networking in order to have SSH access to them from other PCs or laptops on the network. In this case, the guest VM has a static ";}i:2;i:7316;}i:166;a:3:{i:0;s:7:"acronym";i:1;a:1:{i:0;s:3:"LAN";}i:2;i:7746;}i:167;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:29:" IP address, pointing at the ";}i:2;i:7749;}i:168;a:3:{i:0;s:7:"acronym";i:1;a:1:{i:0;s:3:"LAN";}i:2;i:7778;}i:169;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:33:" gateway for internet access and ";}i:2;i:7781;}i:170;a:3:{i:0;s:7:"acronym";i:1;a:1:{i:0;s:3:"DNS";}i:2;i:7814;}i:171;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:112:". Another situation may have you running your VM host on a desktop PC with direct console access via Virtualbox ";}i:2;i:7817;}i:172;a:3:{i:0;s:7:"acronym";i:1;a:1:{i:0;s:3:"GUI";}i:2;i:7929;}i:173;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:89:". This level of configuration is inconsequential as long as you can access your machines.";}i:2;i:7932;}i:174;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:8021;}i:175;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:8021;}i:176;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:372:"It's highly recommended to take machine snapshots after installation and network configuration, before the installation of ZFS to spare yourself time spent troubleshooting if things don't work out. Once you have this snapshot, make a full (as opposed to linked) clone of this base VM to use in the test environment, reinitializing the MAC address of the network interface:";}i:2;i:8023;}i:177;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:8401;}i:178;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:46:"
> vboxmanage clonevm CentOS7Box00 --register
";i:1;N;i:2;N;}i:2;i:8401;}i:179;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:8401;}i:180;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:111:"Change the hostname of this machine to fit a scheme of your choosing, assign it a static IP address, and run a ";}i:2;i:8457;}i:181;a:3:{i:0;s:13:"emphasis_open";i:1;a:0:{}i:2;i:8568;}i:182;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:31:"yum -y update && yum -y upgrade";}i:2;i:8570;}i:183;a:3:{i:0;s:14:"emphasis_close";i:1;a:0:{}i:2;i:8601;}i:184;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:343:" to get the system as up to date as possible. Add a non-root administrative user to the system and add them to the wheel group. Configure SSH to your liking (you may have to start/enable sshd with sysctl), and add any other environment configurations per your preferences. Take another full VM snapshot and we will move on to installing ZFS.  ";}i:2;i:8603;}i:185;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:8946;}i:186;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:8949;}i:187;a:3:{i:0;s:6:"header";i:1;a:3:{i:0;s:14:"Installing ZFS";i:1;i:3;i:2;i:8949;}i:2;i:8949;}i:188;a:3:{i:0;s:12:"section_open";i:1;a:1:{i:0;i:3;}i:2;i:8949;}i:189;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:8949;}i:190;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:294:"The ZFS on Linux DKMS packages are installed from the Extra Packages for Enterprise Linux (EPEL) repositories and are currently not included in CentOS. These repositories track the latest official release for CentOS 6 and 7 on x86_64 architectures. We simply need to download the rpm and run a ";}i:2;i:8975;}i:191;a:3:{i:0;s:13:"emphasis_open";i:1;a:0:{}i:2;i:9269;}i:192;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:8:"rpm -ivh";}i:2;i:9271;}i:193;a:3:{i:0;s:14:"emphasis_close";i:1;a:0:{}i:2;i:9279;}i:194;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:127:" on it. Since wget is not on our minimum installation (unless you added it in the above section), the best way to do this with ";}i:2;i:9281;}i:195;a:3:{i:0;s:13:"emphasis_open";i:1;a:0:{}i:2;i:9408;}i:196;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:16:"yum localinstall";}i:2;i:9410;}i:197;a:3:{i:0;s:14:"emphasis_close";i:1;a:0:{}i:2;i:9426;}i:198;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:".";}i:2;i:9428;}i:199;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:9435;}i:200;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:216:"
# yum localinstall -y --nogpgcheck https://download.fedoraproject.org/pub/epel/7/x86_64/e/epel-release-7-5.noarch.rpm
# yum localinstall -y --nogpgcheck http://archive.zfsonlinux.org/epel/zfs-release.el7.noarch.rpm
";i:1;N;i:2;N;}i:2;i:9435;}i:201;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:9435;}i:202;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:166:"On the CentOS 7.2.1511 installation with which the author initially developed this documentation, GCC needed to be explicitly installed even if the yum install group ";}i:2;i:9661;}i:203;a:3:{i:0;s:18:"doublequoteopening";i:1;a:0:{}i:2;i:9827;}i:204;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:17:"Development Tools";}i:2;i:9828;}i:205;a:3:{i:0;s:18:"doublequoteclosing";i:1;a:0:{}i:2;i:9845;}i:206;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:67:" was included in the installation or installed after the fact. Run:";}i:2;i:9846;}i:207;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:9919;}i:208;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:22:"
# yum -y install gcc
";i:1;N;i:2;N;}i:2;i:9919;}i:209;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:9919;}i:210;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:75:"Installing kernel-devel and the zfs package will complete the installation.";}i:2;i:9951;}i:211;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:10032;}i:212;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:35:"
# yum -y install kernel-devel zfs
";i:1;N;i:2;N;}i:2;i:10032;}i:213;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:10032;}i:214;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:60:"Reboot the machine and check that the ZFS module is present:";}i:2;i:10077;}i:215;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:10143;}i:216;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:20:"
# lsmod | grep zfs
";i:1;N;i:2;N;}i:2;i:10143;}i:217;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:10143;}i:218;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:106:"If you can grep lsmod results that look similar to those below, ZFS is running and ready to begin service:";}i:2;i:10173;}i:219;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:10285;}i:220;a:3:{i:0;s:4:"code";i:1;a:3:{i:0;s:237:"
zfs                  2785315  3
zunicode              331170  1 zfs
zavl                   15236  1 zfs
zcommon                55411  1 zfs
znvpair                89086  2 zfs,zcommon
spl                    92029  3 zfs,zcommon,znvpair
";i:1;N;i:2;N;}i:2;i:10285;}i:221;a:3:{i:0;s:6:"p_open";i:1;a:0:{}i:2;i:10285;}i:222;a:3:{i:0;s:13:"emphasis_open";i:1;a:0:{}i:2;i:10532;}i:223;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:10534;}i:224;a:3:{i:0;s:6:"entity";i:1;a:1:{i:0;s:2:"=>";}i:2;i:10535;}i:225;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:19:" Continue reading: ";}i:2;i:10537;}i:226;a:3:{i:0;s:12:"internallink";i:1;a:2:{i:0;s:15:"principlesofzfs";i:1;s:17:"Principles of ZFS";}i:2;i:10556;}i:227;a:3:{i:0;s:5:"cdata";i:1;a:1:{i:0;s:1:" ";}i:2;i:10593;}i:228;a:3:{i:0;s:6:"entity";i:1;a:1:{i:0;s:2:"=>";}i:2;i:10594;}i:229;a:3:{i:0;s:14:"emphasis_close";i:1;a:0:{}i:2;i:10596;}i:230;a:3:{i:0;s:7:"p_close";i:1;a:0:{}i:2;i:10598;}i:231;a:3:{i:0;s:13:"section_close";i:1;a:0:{}i:2;i:10601;}i:232;a:3:{i:0;s:12:"document_end";i:1;a:0:{}i:2;i:10601;}}